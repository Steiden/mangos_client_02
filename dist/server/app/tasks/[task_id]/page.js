(()=>{var e={};e.id=191,e.ids=[191],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:e=>{"use strict";e.exports=require("assert")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},27910:e=>{"use strict";e.exports=require("stream")},83997:e=>{"use strict";e.exports=require("tty")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},44233:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>l,routeModule:()=>p,tree:()=>c});var a=s(70260),i=s(28203),r=s(25155),n=s.n(r),d=s(67292),o={};for(let e in d)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>d[e]);s.d(t,o);let c=["",{children:["tasks",{children:["[task_id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,41420)),"D:\\Mangos\\mangos_client_02\\src\\app\\tasks\\[task_id]\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,35597)),"D:\\Mangos\\mangos_client_02\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,50042)),"D:\\Mangos\\mangos_client_02\\src\\app\\not-found.tsx"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],l=["D:\\Mangos\\mangos_client_02\\src\\app\\tasks\\[task_id]\\page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/tasks/[task_id]/page",pathname:"/tasks/[task_id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},25017:(e,t,s)=>{Promise.resolve().then(s.bind(s,42740))},61465:(e,t,s)=>{Promise.resolve().then(s.bind(s,23465))},23465:(e,t,s)=>{"use strict";s.d(t,{Task:()=>T});var a=s(45512),i=s(6440),r=s(77548),n=s.n(r),d=s(82281),o=s(77415),c=s(87798),l=s(94520),u=s(54215);let p=()=>{let{task:e}=(0,u.U)();return(0,a.jsxs)("section",{className:(0,d.A)("std-container"),children:[(0,a.jsx)("h1",{className:(0,d.A)("std-h1"),children:e?.name}),(0,a.jsx)("p",{className:(0,d.A)(),children:e?.description})]})};var _=s(79573),m=s(24540),x=s(10805),h=s(41692),v=s(84514),k=s(6736),j=s(7121),f=s(28473);let g=()=>{let[e]=(0,f.Mj)("token",""),{toast:t}=(0,k.dj)(),{task:s,updateTask:i}=(0,u.U)(),{updateProject:r}=(0,v.Om)(),{organization:n}=(0,v.Wf)(),o=async a=>{let n={task_id:s?.id,user_id:a};if(!(await (0,_.vt)(n,e)).success){t({variant:"destructive",title:"Привязка сотрудника к задаче",description:"Ошибка привязки сотрудника к задаче. Попробуйте позже"});return}i(),r(),t({title:"Привязка сотрудника к задаче",description:"Сотрудник успешно привязан к задаче"})};return(0,a.jsxs)("section",{className:(0,d.A)("std-container"),children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:(0,d.A)("std-h1"),children:"Участники"}),(0,a.jsxs)("p",{children:["Список участников задачи ",s?.name]})]}),(0,a.jsxs)("div",{className:(0,d.A)("std-container__content"),children:[(0,a.jsxs)(h.lG,{children:[(0,a.jsx)(h.zM,{className:(0,d.A)((0,m.r)({variant:"outline"}),"self-end"),children:"Добавить участника"}),(0,a.jsxs)(h.Cf,{children:[(0,a.jsxs)(h.c7,{children:[(0,a.jsx)(h.L3,{children:"Добавление участника в задачу"}),(0,a.jsx)(h.rr,{children:"Выбор ведется только из сотрудников вашей организации"})]}),(0,a.jsxs)(x.uB,{filter:(e,t)=>e.includes(t)?1:0,children:[(0,a.jsx)(x.G7,{placeholder:"Поиск сотрудника..."}),(0,a.jsx)(x.oI,{children:(0,a.jsxs)(x.L$,{className:"py-2",children:[(0,a.jsx)(x.xL,{children:"Свободных сотрудников нет."}),n?.members?.filter(e=>!s?.members.find(t=>t.user.id===e.user.id)).map(e=>a.jsx(x.h_,{style:{background:"none",padding:"0"},children:a.jsx(j.A,{member:e,isActions:!1,size:"small",className:"cursor-pointer",onClick:()=>o(e.user.id)})},e.id))]})})]})]})]}),(0,a.jsx)("div",{className:(0,d.A)("std-container"),children:s?.members?.map(e=>a.jsx(j.A,{member:e},e.id))})]})]})};var b=s(51169),y=s(91903),A=s(62764),P=s(98838),N=s(53568),w=s(74864),q=s(58009);let S=()=>{let[e]=(0,f.Mj)("token",""),{toast:t}=(0,k.dj)(),{task:s,updateTask:i}=(0,u.U)(),{updateProject:r}=(0,v.Om)(),{updateOrganization:n}=(0,v.Wf)(),[o,c]=(0,q.useState)({name:s?.name||"",description:s?.description||"",started_at:s?.started_at||new Date,finished_at:s?.finished_at||new Date,execution_status_id:s?.execution_status.id||0,task_priority_id:s?.task_priority.id||0,category_id:s?.category.id||0}),[l,p]=(0,q.useState)({executionStatuses:[],taskPriorities:[],categories:[]}),_=[{type:"text",id:"name",name:"name",placeholder:"Название задачи",value:o.name},{type:"text",id:"description",name:"description",placeholder:"Описание задачи",value:o.description},{type:"date",id:"started_at",name:"started_at",placeholder:"Дата начала выполнения",value:o.started_at},{type:"date",id:"finished_at",name:"finished_at",placeholder:"Дата завершения выполнения",value:o.finished_at},{type:"combobox",id:"execution_status_id",name:"execution_status_id",placeholder:"Статус выполнения",data_name:"executionStatuses",value:{id:l.executionStatuses.find(e=>e.id===o.execution_status_id)?.id||0,name:l.executionStatuses.find(e=>e.id===o.execution_status_id)?.name||""}},{type:"combobox",id:"task_priority_id",name:"task_priority_id",placeholder:"Приоритет",data_name:"taskPriorities",value:{id:l.taskPriorities.find(e=>e.id===o.task_priority_id)?.id||0,name:l.taskPriorities.find(e=>e.id===o.task_priority_id)?.name||""}},{type:"combobox",id:"category_id",name:"category_id",placeholder:"Категория",data_name:"categories",value:{id:l.categories.find(e=>e.id===o.category_id)?.id||0,name:l.categories.find(e=>e.id===o.category_id)?.name||""}}],x=async a=>{if(a.preventDefault(),!s){t({variant:"destructive",title:"Сохранение задачи",description:"Выберите задачу для сохранения её настроек"});return}if(!(await (0,P.yo)(s?.id,o,e)).success){t({variant:"destructive",title:"Сохранение задачи",description:"При сохранении задачи произошла ошибка. Попробуйте позже"});return}i(),r(),n(),t({title:"Сохранение задачи",description:"Настройки задачи успешно сохранены"})};return(0,q.useEffect)(()=>{(async function(){try{let t=await (0,b.vS)(e),s=await (0,y.vS)(e),a=await (0,A.vS)(e);p({...l,taskPriorities:s.success?s.data:[],executionStatuses:t.success?t.data.map(e=>({id:e.id,name:e.caption})):[],categories:a.success?a.data:[]})}catch{t({variant:"destructive",title:"Ошибка",description:"Ошибка загрузки данных. Попробуйте позже"})}})()},[]),(0,a.jsxs)("section",{className:(0,d.A)("std-container"),children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:(0,d.A)("std-h1"),children:"Настройки"}),(0,a.jsx)("p",{children:"Настройте параметры вашей задачи"})]}),(0,a.jsxs)("form",{className:(0,d.A)("std-container__content"),onSubmit:x,children:[_.map(e=>(0,a.jsxs)("div",{className:"grid w-full max-w-sm items-center gap-1.5",children:[(0,a.jsx)(w.J,{htmlFor:e.name,children:e.placeholder}),(0,N.h)(e,t=>c({...o,[e.name]:t}),l)]},e.id)),(0,a.jsx)(m.$,{variant:"outline",type:"submit",className:(0,d.A)("std-button"),children:"Сохранить"})]})]})},T=()=>(0,a.jsxs)(i.tU,{orientation:"vertical",defaultValue:"about",className:(0,d.A)(n().task),children:[(0,a.jsxs)(i.j7,{className:(0,d.A)(n().task__tabs),children:[(0,a.jsxs)(i.Xi,{value:"about",className:(0,d.A)(n().task__tab),children:[(0,a.jsx)(o.A,{width:20,height:20}),"О задаче"]}),(0,a.jsxs)(i.Xi,{value:"members",className:(0,d.A)(n().task__tab),children:[(0,a.jsx)(c.A,{width:20,height:20})," Участники"]}),(0,a.jsxs)(i.Xi,{value:"settings",className:(0,d.A)(n().task__tab),children:[(0,a.jsx)(l.A,{width:20,height:20})," Настройки"]})]}),(0,a.jsx)(i.av,{value:"about",className:(0,d.A)(n().task__content),children:(0,a.jsx)(p,{})}),(0,a.jsx)(i.av,{value:"members",className:(0,d.A)(n().task__content),children:(0,a.jsx)(g,{})}),(0,a.jsx)(i.av,{value:"settings",className:(0,d.A)(n().task__content),children:(0,a.jsx)(S,{})})]})},51169:(e,t,s)=>{"use strict";s.d(t,{vS:()=>n});var a=s(98261),i=s(72043),r=s(36092);async function n(e){try{return(await a.FH.get(i.v.execution_statuses,(0,a.zP)(e))).data}catch(e){return(0,r.N)(e)}}},77548:e=>{e.exports={task:"Task_task__WqEcX",task__tabs:"Task_task__tabs__H4mO0",task__tab:"Task_task__tab__JCpgd",task__content:"Task_task__content__PLagq"}},42740:(e,t,s)=>{"use strict";s.d(t,{Task:()=>a});let a=(0,s(46760).registerClientReference)(function(){throw Error("Attempted to call Task() from the server but Task is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\Mangos\\mangos_client_02\\src\\_pages\\Tasks\\[task_id]\\Task.tsx","Task")},41420:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n,generateStaticParams:()=>r});var a=s(62740),i=s(42740);function r(){return[{id:"test"}]}function n(e){return(0,a.jsx)(i.Task,{})}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[638,812,105,296,85,258],()=>s(44233));module.exports=a})();