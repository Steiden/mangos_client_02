(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[208],{3189:(e,t,a)=>{Promise.resolve().then(a.bind(a,9731))},8685:(e,t,a)=>{"use strict";a.d(t,{h:()=>v});var s=a(5155),r=a(2115),d=a(32),i=a(2423),n=a(1567),l=a(7566),o=a(3518),c=a(6967),u=a(2222),m=a(7549);function p(e){let{className:t,classNames:a,showOutsideDays:r=!0,...d}=e;return(0,s.jsx)(u.hv,{showOutsideDays:r,className:(0,m.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,m.cn)((0,l.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:(0,m.cn)("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md","range"===d.mode?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:(0,m.cn)((0,l.r)({variant:"ghost"}),"h-8 w-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:e=>{let{...t}=e;return(0,s.jsx)(o.A,{className:"h-4 w-4"})},IconRight:e=>{let{...t}=e;return(0,s.jsx)(c.A,{className:"h-4 w-4"})}},...d})}p.displayName="Calendar";var f=a(4765);function x(e){let{value:t,onChange:a}=e,[o,c]=r.useState(t);return(0,s.jsxs)(f.AM,{children:[(0,s.jsx)(f.Wv,{asChild:!0,children:(0,s.jsxs)(l.$,{variant:"outline",className:(0,n.cn)("w-[240px] justify-start text-left font-normal",!o&&"text-muted-foreground"),children:[(0,s.jsx)(i.A,{}),o?(0,d.GP)(o,"PPP"):(0,s.jsx)("span",{children:"Выберите дату"})]})}),(0,s.jsx)(f.hl,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(p,{mode:"single",selected:o||void 0,onSelect:e=>{c(e||null),a(e?(0,d.GP)(e,"yyyy-MM-dd"):"")},initialFocus:!0})})]})}var h=a(166),y=a(3486),g=a(4144);let v=(e,t,a)=>{var r,d,i;return(0,s.jsx)(s.Fragment,{children:"date"===e.type?(0,s.jsx)(x,{onChange:e=>t(e),value:e.value,...e}):"textarea"===e.type?(0,s.jsx)(g.T,{onChange:e=>t(e.target.value),value:e.value||"",...e}):"combobox"===e.type?(0,s.jsx)(y.u,{items:(null===(r=a[e.data_name])||void 0===r?void 0:r.map(e=>({label:e.name,value:e.id.toString()})))||[],selectedItem:{label:null===(d=e.value)||void 0===d?void 0:d.name,value:null===(i=e.value)||void 0===i?void 0:i.id},onChange:e=>t(+e)}):(0,s.jsx)(h.p,{value:e.value,onChange:e=>t(e.target.value),...e,placeholder:""})})}},1567:(e,t,a)=>{"use strict";a.d(t,{cn:()=>d});var s=a(3463),r=a(9795);function d(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},3486:(e,t,a)=>{"use strict";a.d(t,{u:()=>y});var s=a(5155),r=a(2115),d=a(7899),i=a(1719),n=a(1902),l=a(8867),o=a(7549);let c=d.bL;d.YJ;let u=d.WT,m=r.forwardRef((e,t)=>{let{className:a,children:r,...n}=e;return(0,s.jsxs)(d.l9,{ref:t,className:(0,o.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...n,children:[r,(0,s.jsx)(d.In,{asChild:!0,children:(0,s.jsx)(i.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=d.l9.displayName;let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(d.PP,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})});p.displayName=d.PP.displayName;let f=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(d.wn,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(i.A,{className:"h-4 w-4"})})});f.displayName=d.wn.displayName;let x=r.forwardRef((e,t)=>{let{className:a,children:r,position:i="popper",...n}=e;return(0,s.jsx)(d.ZL,{children:(0,s.jsxs)(d.UC,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:i,...n,children:[(0,s.jsx)(p,{}),(0,s.jsx)(d.LM,{className:(0,o.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(f,{})]})})});x.displayName=d.UC.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(d.JU,{ref:t,className:(0,o.cn)("px-2 py-1.5 text-sm font-semibold",a),...r})}).displayName=d.JU.displayName;let h=r.forwardRef((e,t)=>{let{className:a,children:r,...i}=e;return(0,s.jsxs)(d.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...i,children:[(0,s.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(d.VF,{children:(0,s.jsx)(l.A,{className:"h-4 w-4"})})}),(0,s.jsx)(d.p4,{children:r})]})});h.displayName=d.q7.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(d.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=d.wv.displayName;let y=e=>{let{placeholder:t,items:a,selectedItem:r,onChange:d}=e;return(0,s.jsxs)(c,{onValueChange:d,children:[(0,s.jsx)(m,{className:"w-[100%]",children:(0,s.jsx)(u,{placeholder:(null==r?void 0:r.label)||t})}),(0,s.jsx)(x,{children:a.map(e=>(0,s.jsx)(h,{value:e.value,children:e.label},e.value))})]})}},166:(e,t,a)=>{"use strict";a.d(t,{p:()=>i});var s=a(5155),r=a(2115),d=a(7549);let i=r.forwardRef((e,t)=>{let{className:a,type:r,...i}=e;return(0,s.jsx)("input",{type:r,className:(0,d.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...i})});i.displayName="Input"},300:(e,t,a)=>{"use strict";a.d(t,{J:()=>o});var s=a(5155),r=a(2115),d=a(6195),i=a(1027),n=a(7549);let l=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(d.b,{ref:t,className:(0,n.cn)(l(),a),...r})});o.displayName=d.b.displayName},4765:(e,t,a)=>{"use strict";a.d(t,{AM:()=>n,Wv:()=>l,hl:()=>o});var s=a(5155),r=a(2115),d=a(2337),i=a(7549);let n=d.bL,l=d.l9;d.Mz;let o=r.forwardRef((e,t)=>{let{className:a,align:r="center",sideOffset:n=4,...l}=e;return(0,s.jsx)(d.ZL,{children:(0,s.jsx)(d.UC,{ref:t,align:r,sideOffset:n,className:(0,i.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})})});o.displayName=d.UC.displayName},4144:(e,t,a)=>{"use strict";a.d(t,{T:()=>i});var s=a(5155),r=a(2115),d=a(7549);let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("textarea",{className:(0,d.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});i.displayName="Textarea"},9731:(e,t,a)=>{"use strict";a.d(t,{TasksCreate:()=>b});var s=a(5155),r=a(3463),d=a(8661),i=a.n(d),n=a(7566),l=a(300),o=a(2115),c=a(6390),u=a(6870),m=a(6046),p=a(2756),f=a(5432),x=a(3804),h=a(8685),y=a(2562),g=a(114);let v=[{type:"text",id:"name",name:"name",placeholder:"Название задачи"},{type:"text",id:"description",name:"description",placeholder:"Описание задачи"},{type:"date",id:"started_at",name:"started_at",placeholder:"Дата начала"},{type:"date",id:"finished_at",name:"finished_at",placeholder:"Дата завершения"},{type:"combobox",id:"task_priority_id",name:"task_priority_id",placeholder:"Приоритет",data_name:"taskPriorities"},{type:"combobox",id:"category_id",name:"category_id",placeholder:"Категория",data_name:"categories"}],b=()=>{let e=(0,m.useRouter)(),{user:t}=(0,f.ur)(),{organization:a}=(0,f.Wf)(),{project:d}=(0,f.Om)(),{toast:b}=(0,u.dj)(),[w]=(0,c.Mj)("token",""),[_,j]=(0,o.useState)({name:"",description:"",started_at:new Date,finished_at:new Date,execution_status_id:y.J7.in_progress,task_priority_id:0,category_id:0,user_id:0,project_id:0}),[N,k]=(0,o.useState)({taskPriorities:[],categories:[]});(0,o.useEffect)(()=>{a&&k({...N,categories:a.categories})},[a]),(0,o.useEffect)(()=>{(async function(){try{let e=await (0,g.vS)(w);k({...N,taskPriorities:e.success?e.data:[]})}catch(e){b({variant:"destructive",title:"Ошибка",description:"Ошибка загрузки данных. Попробуйте позже"})}})()},[w]);let C=async()=>{_.user_id=null==t?void 0:t.id,_.project_id=null==d?void 0:d.id;let e=await (0,p.vt)(_,w);return e.success?e.data:(b({variant:"destructive",title:"Создание задачи",description:"Ошибка создания задачи. Попробуйте позже"}),null)},P=async e=>{let a={task_id:e,user_id:null==t?void 0:t.id},s=await (0,x.vt)(a,w);return s.success?s.data:(b({variant:"destructive",title:"Привязка к задаче",description:"Ошибка привязки к задаче. Попробуйте позже"}),null)},A=async t=>{t.preventDefault();let a=await C();a&&await P(a.id)&&(b({title:"Создание задачи",description:"Задача успешно создана"}),e.push("/tasks"))};return(0,s.jsxs)("section",{className:(0,r.A)("std-center",i()["tasks-create"]),children:[(0,s.jsx)("h1",{className:(0,r.A)("std-h1",i()["tasks-create__title"]),children:"Создание задачи"}),(0,s.jsxs)("form",{className:(0,r.A)(i()["tasks-create__form"]),onSubmit:A,children:[v.map(e=>(0,s.jsxs)("div",{className:"grid w-full max-w-sm items-center gap-1.5",children:[(0,s.jsx)(l.J,{htmlFor:e.name,children:e.placeholder}),(0,h.h)(e,t=>j({..._,[e.name]:t}),N)]},e.id)),(0,s.jsx)(n.$,{variant:"outline",type:"submit",className:(0,r.A)("std-button",i()["tasks-create__button"]),children:"Создать"})]})]})}},8661:e=>{e.exports={"tasks-create":"TasksCreate_tasks-create__1pPQN","tasks-create__form":"TasksCreate_tasks-create__form__47anN"}}},e=>{var t=t=>e(e.s=t);e.O(0,[413,478,651,9,481,544,778,441,517,358],()=>t(3189)),_N_E=e.O()}]);