(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[811],{4420:(e,a,t)=>{Promise.resolve().then(t.bind(t,6489))},9316:(e,a,t)=>{"use strict";t.d(a,{vS:()=>l});var i=t(676),s=t(6613),n=t(776);async function l(e){try{return(await i.FH.get(s.v.activity_types,(0,i.zP)(e))).data}catch(e){return(0,n.N)(e)}}},6489:(e,a,t)=>{"use strict";t.d(a,{Organization:()=>V});var i=t(5155),s=t(8108),n=t.n(s),l=t(5390),r=t(3463),d=t(4995),c=t(1466),o=t(7401);let u=(0,o.A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);var v=t(8236),h=t(4003);let m=()=>{let{organization:e}=(0,h.useOrganizationContext)();return(0,i.jsxs)("section",{className:(0,r.A)("std-container"),children:[(0,i.jsx)("h1",{className:(0,r.A)("std-h1"),children:null==e?void 0:e.name}),(0,i.jsx)("p",{className:(0,r.A)(),children:null==e?void 0:e.description})]})};var x=t(5432),p=t(795);let g=()=>{var e;let{organization:a}=(0,x.Wf)();return(0,i.jsxs)("section",{className:(0,r.A)("std-container"),children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:(0,r.A)("std-h1"),children:"Участники"}),(0,i.jsxs)("p",{children:["Список сотрудников организации ",null==a?void 0:a.name]})]}),(0,i.jsx)("div",{className:(0,r.A)("std-container__content"),children:(0,i.jsx)("div",{className:(0,r.A)("std-container"),children:null==a?void 0:null===(e=a.members)||void 0===e?void 0:e.map(e=>(0,i.jsx)(p.A,{member:e},e.id))})})]})};var j=t(2673),_=t(9316),f=t(4393),y=t(5681),N=t(8685),b=t(2115),z=t(1027),A=t(7549);let w=(0,z.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function k(e){let{className:a,variant:t,...s}=e;return(0,i.jsx)("div",{className:(0,A.cn)(w({variant:t}),a),...s})}var C=t(7566),M=t(166),S=t(300),O=t(4765),F=t(6870);let W=(0,o.A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var E=t(6390);let P=()=>{var e,a;let[t]=(0,E.Mj)("token",""),{toast:s}=(0,F.dj)(),{organization:n,updateOrganization:l}=(0,x.Wf)(),[d,c]=(0,b.useState)({description:null==n?void 0:n.description,name:null==n?void 0:n.name,full_name:null==n?void 0:n.full_name,address:null==n?void 0:n.address,phone:null==n?void 0:n.phone,activity_type_id:(null==n?void 0:n.activity_type.id)||0}),[o,u]=(0,b.useState)({tags:(null==n?void 0:n.tags)||[],categories:(null==n?void 0:n.categories)||[]}),[v,h]=(0,b.useState)({activityTypes:[]}),[m,p]=(0,b.useState)(""),[g,z]=(0,b.useState)(""),A=[{type:"text",id:"name",name:"name",placeholder:"Название задачи",value:d.name},{type:"text",id:"full_name",name:"full_name",placeholder:"Полное название организации",value:d.full_name},{type:"textarea",id:"description",name:"description",placeholder:"Описание организации",value:d.description},{type:"text",id:"address",name:"address",placeholder:"Адрес организации",value:d.address},{type:"tel",id:"phone",name:"phone",placeholder:"Телефон организации",value:d.phone},{type:"combobox",id:"activity_type_id",name:"activity_type_id",placeholder:"Тип активности",data_name:"activityTypes",value:{id:(null===(e=v.activityTypes.find(e=>e.id===d.activity_type_id))||void 0===e?void 0:e.id)||0,name:(null===(a=v.activityTypes.find(e=>e.id===d.activity_type_id))||void 0===a?void 0:a.name)||""}}],w=async e=>{if(e.preventDefault(),!n){s({variant:"destructive",title:"Сохранение организации",description:"Выберите организацию для сохранения её настроек"});return}if(!(await (0,j.yo)(null==n?void 0:n.id,d,t)).success){s({variant:"destructive",title:"Сохранение организации",description:"При сохранении организации произошла ошибка. Попробуйте позже"});return}l(),s({title:"Сохранение организации",description:"Настройки организации успешно сохранены"})},P=async()=>{let e={name:m,organization_id:null==n?void 0:n.id},a=await (0,y.vt)(e,t);if(!a.success){s({variant:"destructive",title:"Добавление тега",description:"При добавлении тега произошла ошибка. Попробуйте позже"});return}p("");let i={id:a.data.id,name:a.data.name,organization_id:(null==n?void 0:n.id)||(null==n?void 0:n.id)||0,created_at:a.data.created_at,updated_at:a.data.updated_at};u({...o,tags:[...o.tags,i]})},T=async()=>{let e={name:g,organization_id:null==n?void 0:n.id},a=await (0,f.vt)(e,t);if(!a.success){s({variant:"destructive",title:"Добавление категории",description:"При добавлении категории произошла ошибка. Попробуйте позже"});return}z("");let i={id:a.data.id,name:a.data.name,organization_id:(null==n?void 0:n.id)||(null==n?void 0:n.id)||0,created_at:a.data.created_at,updated_at:a.data.updated_at};u({...o,categories:[...o.categories,i]})};return(0,b.useEffect)(()=>{(async function(){try{let e=await (0,_.vS)(t);h({...v,activityTypes:e.success?e.data:[]})}catch(e){s({variant:"destructive",title:"Ошибка",description:"Ошибка загрузки данных. Попробуйте позже"})}})()},[]),(0,i.jsxs)("section",{className:(0,r.A)("std-container"),children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:(0,r.A)("std-h1"),children:"Настройки"}),(0,i.jsx)("p",{children:"Настройте параметры вашей организации"})]}),(0,i.jsxs)("form",{className:(0,r.A)("std-container__content"),onSubmit:w,children:[A.map(e=>(0,i.jsxs)("div",{className:"grid w-full max-w-sm items-center gap-1.5",children:[(0,i.jsx)(S.J,{htmlFor:e.name,children:e.placeholder}),(0,N.h)(e,a=>c({...d,[e.name]:a}),v)]},e.id)),(0,i.jsxs)("div",{className:"grid w-full max-w-sm items-center gap-1.5",children:[(0,i.jsx)(S.J,{htmlFor:"tags",children:"Теги"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[null==o?void 0:o.tags.map(e=>(0,i.jsx)(k,{variant:"outline",children:e.name},e.id)),(0,i.jsxs)(O.AM,{children:[(0,i.jsx)(O.Wv,{className:"flex items-center gap-1 text-sm",children:(0,i.jsxs)(k,{children:[(0,i.jsx)(W,{width:15,height:15}),"Добавить"]})}),(0,i.jsxs)(O.hl,{className:"flex flex-col gap-2",children:[(0,i.jsx)(M.p,{value:m,onChange:e=>p(e.target.value)}),(0,i.jsx)(C.$,{variant:"outline",onClick:P,children:"Добавить"})]})]})]})]}),(0,i.jsxs)("div",{className:"grid w-full max-w-sm items-center gap-1.5",children:[(0,i.jsx)(S.J,{htmlFor:"tags",children:"Категории"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[null==o?void 0:o.categories.map(e=>(0,i.jsx)(k,{variant:"outline",children:e.name},e.id)),(0,i.jsxs)(O.AM,{children:[(0,i.jsx)(O.Wv,{className:"flex items-center gap-1 text-sm",children:(0,i.jsxs)(k,{children:[(0,i.jsx)(W,{width:15,height:15}),"Добавить"]})}),(0,i.jsxs)(O.hl,{className:"flex flex-col gap-2",children:[(0,i.jsx)(M.p,{value:g,onChange:e=>z(e.target.value)}),(0,i.jsx)(C.$,{variant:"outline",onClick:T,children:"Добавить"})]})]})]})]}),(0,i.jsx)(C.$,{variant:"outline",type:"submit",className:(0,r.A)("std-button"),children:"Сохранить"})]})]})};var T=t(676),X=t(6613),$=t(776);async function H(e,a){try{return(await T.FH.post(X.v.divisions,e,(0,T.zP)(a))).data}catch(e){return(0,$.N)(e)}}async function J(e,a){try{return(await T.FH.post(X.v.posts,e,(0,T.zP)(a))).data}catch(e){return(0,$.N)(e)}}var D=t(1898);let U=()=>{let[e]=(0,E.Mj)("token",""),{toast:a}=(0,F.dj)(),{user:t}=(0,x.ur)(),{organization:s,updateOrganization:n}=(0,x.Wf)(),[l,d]=(0,b.useState)(""),[c,o]=(0,b.useState)(""),u=async i=>{i.preventDefault();let r={user_id:null==t?void 0:t.id,organization_id:null==s?void 0:s.id,name:l};if(!(await H(r,e)).success){a({variant:"destructive",title:"Создание подразделения",description:"Ошибка создания подразделения. Попробуйте позже"});return}d(""),n(),a({title:"Создание подразделения",description:"Подразделение успешно создано"})},v=async t=>{if(!(await J({division_id:t,name:c},e)).success){a({variant:"destructive",title:"Создание должности",description:"Ошибка создания должности. Попробуйте позже"});return}o(""),n(),a({title:"Создание должности",description:"Должность успешно создана"})};return(0,i.jsxs)("section",{className:(0,r.A)("std-container"),children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:(0,r.A)("std-h1"),children:"Подразделения"}),(0,i.jsx)("p",{children:"Настройте иерархию в вашей организации"})]}),(0,i.jsxs)("div",{className:(0,r.A)("std-container__content"),children:[(0,i.jsxs)(D.lG,{children:[(0,i.jsx)(D.zM,{className:(0,r.A)((0,C.r)({variant:"outline"}),"self-end"),children:"Создать подразделение"}),(0,i.jsx)(D.Cf,{children:(0,i.jsxs)(D.c7,{children:[(0,i.jsx)(D.L3,{children:"Создание подразделения"}),(0,i.jsxs)("form",{className:"flex flex-col gap-2",onSubmit:u,children:[(0,i.jsx)(M.p,{value:l,onChange:e=>d(e.target.value)}),(0,i.jsx)(C.$,{variant:"outline",className:"std-button w-fit self-center",children:"Создать"})]})]})})]}),(0,i.jsx)("div",{className:"flex flex-col gap-3 w-full",children:null==s?void 0:s.divisions.map(e=>(0,i.jsxs)("div",{className:"border border-input rounded-md shadow-sm w-full px-5 py-3",children:[(0,i.jsx)("h2",{className:"std-h2",children:e.name}),(0,i.jsx)("div",{className:"grid w-full items-center gap-1.5 mt-5",children:(0,i.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[null==e?void 0:e.posts.map(e=>(0,i.jsx)(k,{variant:"outline",className:"text-md font-normal w-max",children:e.name},e.id)),(0,i.jsxs)(O.AM,{children:[(0,i.jsx)(O.Wv,{className:"flex items-center gap-1",children:(0,i.jsxs)(k,{className:"flex gap-1 text-md",children:[(0,i.jsx)(W,{width:20,height:20}),"Добавить должность"]})}),(0,i.jsxs)(O.hl,{className:"flex flex-col gap-2",children:[(0,i.jsx)(M.p,{value:c,onChange:e=>o(e.target.value)}),(0,i.jsx)(C.$,{variant:"outline",onClick:()=>v(e.id),children:"Добавить"})]})]})]})})]},e.id))})]})]})},V=()=>(0,i.jsxs)(l.tU,{orientation:"vertical",defaultValue:"about",className:(0,r.A)(n().organization),children:[(0,i.jsxs)(l.j7,{className:(0,r.A)(n().organization__tabs),children:[(0,i.jsxs)(l.Xi,{value:"about",className:(0,r.A)(n().organization__tab),children:[(0,i.jsx)(d.A,{width:20,height:20}),"Об организации"]}),(0,i.jsxs)(l.Xi,{value:"members",className:(0,r.A)(n().organization__tab),children:[(0,i.jsx)(c.A,{width:20,height:20})," Участники"]}),(0,i.jsxs)(l.Xi,{value:"divisions",className:(0,r.A)(n().organization__tab),children:[(0,i.jsx)(u,{width:20,height:20})," Подразделения"]}),(0,i.jsxs)(l.Xi,{value:"settings",className:(0,r.A)(n().organization__tab),children:[(0,i.jsx)(v.A,{width:20,height:20})," Настройки"]})]}),(0,i.jsx)(l.av,{value:"about",className:(0,r.A)(n().organization__content),children:(0,i.jsx)(m,{})}),(0,i.jsx)(l.av,{value:"members",className:(0,r.A)(n().organization__content),children:(0,i.jsx)(g,{})}),(0,i.jsx)(l.av,{value:"divisions",className:(0,r.A)(n().organization__content),children:(0,i.jsx)(U,{})}),(0,i.jsx)(l.av,{value:"settings",className:(0,r.A)(n().organization__content),children:(0,i.jsx)(P,{})})]})},8108:e=>{e.exports={organization:"Organization_organization__B8b76",organization__tabs:"Organization_organization__tabs__hWEJv",organization__tab:"Organization_organization__tab__ZtczX",organization__content:"Organization_organization__content__hOlQY"}}},e=>{var a=a=>e(e.s=a);e.O(0,[719,478,651,9,481,544,631,822,778,987,441,517,358],()=>a(4420)),_N_E=e.O()}]);